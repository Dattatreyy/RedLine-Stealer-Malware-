# RedLine-Stealer-Malware

1. Attack Vector: Info Stealer

2. Method of Distribution: Phishing Emails, Telegram installer, fake windows update (through malicious domain: windows-upgraded.com)

3. What this Malware do ?

This Malware steals the information from browsers such as saved credentials, cookies, autocomplete data, and credit card information.The malware will collect all your social media, banking and other digital passwords from your computer and put them on sale on the Darkweb.

Redline Stealer is also capable of performing basic downloads and execute functions. This Malware can download files from specified links, run executables programs and open links via browser.

![image](https://user-images.githubusercontent.com/107531426/179386501-83807e50-20a5-40f7-8040-3ce1cca11a2e.png)

# Analysis

SHA256: 88c7f392ce31bf4c22e7dad57ba893e9ae58e11cf0fd710482c59d172865df24
(https://bazaar.abuse.ch/sample/88c7f392ce31bf4c22e7dad57ba893e9ae58e11cf0fd710482c59d172865df24/)

Lets execute the sample and Check the Process. These all marked strings are malicious and related to RedLine Stealer.

<img width="691" alt="nrl5" src="https://user-images.githubusercontent.com/107531426/179386993-a84e3e16-5c18-41da-adeb-313f3311c146.PNG">


Similarly checking network activity. 

<img width="760" alt="nrl1" src="https://user-images.githubusercontent.com/107531426/179387058-2651489e-34de-4516-b9c1-65c51170a2a2.PNG">
<img width="760" alt="nrl2" src="https://user-images.githubusercontent.com/107531426/179387060-ccd8a206-5256-440b-b716-b481cda496d9.PNG">

Here Malware trying to communicate with the attackerâ€™s C2 using IP: 193.106.191.81. And if you check the VT, clearly this IP is assosiated with RedLine Stealer.


<img width="760" alt="nrl3" src="https://user-images.githubusercontent.com/107531426/179387242-3f922112-a64e-446c-a1f9-a17516c2b370.PNG">
<img width="739" alt="nrl4" src="https://user-images.githubusercontent.com/107531426/179387245-799069c0-da25-449d-92ca-c9f1847ad32d.PNG">

# Unpacking the Binary

If you check the Entropy, Strings, and Import table of the sample you'll know that the file is packed. 

So, Here I'm unapcking the file


Load the sample in debugger and run. It will take you to the Entrypoint of the sample.

<img width="563" alt="rl1" src="https://user-images.githubusercontent.com/107531426/179387473-0fc2faa9-82bb-4b4f-87bb-1d43198cd7b4.PNG">

Search for VirtualProtect, the Memory API where Malware used to unpacking itself in memory. Hit the JMP instruction. 

<img width="507" alt="rl2" src="https://user-images.githubusercontent.com/107531426/179387478-917bc10e-bd16-490a-bb93-9a7a207a7ea1.PNG">

After hitting the JMP instruction , search for Ret instruction. It is last point of the memory API, Here we need to put BreakPoint.

<img width="561" alt="rl3" src="https://user-images.githubusercontent.com/107531426/179387482-7bb4aaa4-bb27-496c-a63f-c74e3ac5b487.PNG">

Now go to the Entrypoint again and Run the Malware untill it hit Return instruction. Then do Step Over.

Do the "Follow in Dump" to the Address. Check in the Dump for PE Header. Here we will not find that in this Address.

<img width="565" alt="rl4" src="https://user-images.githubusercontent.com/107531426/179387484-597ca23c-8dd6-4dfc-bc8b-ead64b87da43.PNG">

Now again follow the same process. Run & Step Over and check in dump for selected address.

<img width="557" alt="rl5" src="https://user-images.githubusercontent.com/107531426/179387487-0f3800bb-a243-4c8f-856e-e5d3c613b7b9.PNG">

Here if we dump the address "[ebp-C]", We can PE Header in the Dump. This is our Unpacked Malware.

Follow the "MZ" to the Memory Map

<img width="620" alt="Capture" src="https://user-images.githubusercontent.com/107531426/179387586-56b236f2-a487-42b1-9884-e8dd9b0e94c1.PNG">

Export your Unpacked file from here

<img width="573" alt="rl7" src="https://user-images.githubusercontent.com/107531426/179387494-25c15be0-f6c3-42c8-870f-de7d6b8de145.PNG">

So Here are the some Information about our Unpacked Malware.

<img width="329" alt="rl8" src="https://user-images.githubusercontent.com/107531426/179387915-3cdbd505-2219-478f-9aab-5c8da426ac94.PNG">


# References
1. https://asec.ahnlab.com/en/29885/
2. https://threatresearch.ext.hp.com/redline-stealer-disguised-as-a-windows-11-upgrade/
3. https://resources.infosecinstitute.com/topic/redline-stealer-malware-full-analysis/
4. https://techunwrapped.com/windows-11-beware-of-this-fake-update-it-infects-the-pc-with-the-redline-stealer-malware/
5. https://blog.cyble.com/2021/08/12/a-deep-dive-analysis-of-redline-stealer-malware/
